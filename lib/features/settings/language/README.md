# å¤šèªè¨€åˆ‡æ›åŠŸèƒ½å¯¦ç¾

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

æœ¬æ¨¡çµ„å¯¦ç¾äº† PM25 æ‡‰ç”¨ç¨‹å¼çš„å¤šèªè¨€åˆ‡æ›åŠŸèƒ½ï¼Œæ”¯æ´è‹±æ–‡å’Œç¹é«”ä¸­æ–‡ï¼Œä¸¦æä¾›å®Œæ•´çš„èªè¨€ç®¡ç†æ©Ÿåˆ¶ã€‚

## ğŸ—ï¸ æ¶æ§‹è¨­è¨ˆ

### æª”æ¡ˆçµæ§‹
```
lib/features/settings/language/
â”œâ”€â”€ language_constants.dart      # èªè¨€å¸¸æ•¸å®šç¾©
â”œâ”€â”€ language_provider.dart       # Provider ç‹€æ…‹ç®¡ç†
â”œâ”€â”€ language_repository.dart     # è³‡æ–™å­˜å–å±¤
â””â”€â”€ README.md                   # èªªæ˜æ–‡ä»¶

lib/core/services/
â””â”€â”€ language_service.dart       # èªè¨€æœå‹™

lib/core/constants/language/
â”œâ”€â”€ language_constants.dart     # èªè¨€å¸¸æ•¸
â””â”€â”€ l10n/                      # æœ¬åœ°åŒ–è³‡æº
    â”œâ”€â”€ app_en.arb             # è‹±æ–‡ç¿»è­¯
    â”œâ”€â”€ app_zh.arb             # ä¸­æ–‡ç¿»è­¯ï¼ˆfallbackï¼‰
    â””â”€â”€ app_zh_TW.arb          # ç¹é«”ä¸­æ–‡ç¿»è­¯

lib/ui/widgets/
â””â”€â”€ language_selector.dart     # èªè¨€é¸æ“‡å™¨çµ„ä»¶

lib/ui/screens/setting/normal/language/
â””â”€â”€ language_settings_screen.dart  # èªè¨€è¨­å®šé é¢
```

## ğŸ”§ æ ¸å¿ƒçµ„ä»¶

### 1. LanguageConstants
å®šç¾©æ”¯æ´çš„èªè¨€æ¸…å–®å’Œç›¸é—œå¸¸æ•¸ï¼š
- æ”¯æ´èªè¨€ï¼šè‹±æ–‡ (en)ã€ç¹é«”ä¸­æ–‡ (zh_TW)
- é è¨­èªè¨€ï¼šç¹é«”ä¸­æ–‡
- èªè¨€è³‡è¨Šæ¨¡å‹ï¼šLanguageInfo

### 2. LanguageService
æ ¸å¿ƒèªè¨€æœå‹™ï¼Œè² è²¬ï¼š
- èªè¨€åå¥½è¨­å®šçš„å„²å­˜å’Œè¼‰å…¥
- Locale ç‰©ä»¶çš„ç”Ÿæˆ
- èªè¨€åˆ‡æ›çš„åº•å±¤å¯¦ç¾

### 3. LanguageRepository
è³‡æ–™å­˜å–å±¤ï¼Œæä¾›ï¼š
- çµ±ä¸€çš„è³‡æ–™å­˜å–ä»‹é¢
- éŒ¯èª¤è™•ç†å’Œæ—¥èªŒè¨˜éŒ„
- èˆ‡ LanguageService çš„æ•´åˆ

### 4. LanguageProvider
ç‹€æ…‹ç®¡ç†ï¼Œæä¾›ï¼š
- èªè¨€ç‹€æ…‹çš„çµ±ä¸€ç®¡ç†
- èªè¨€åˆ‡æ›çš„æ¥­å‹™é‚è¼¯
- UI ç‹€æ…‹çš„æ›´æ–°é€šçŸ¥

## ğŸ¨ UI çµ„ä»¶

### 1. LanguageSelector
ç°¡æ½”çš„èªè¨€é¸æ“‡å™¨ï¼Œæä¾›ï¼š
- å°è©±æ¡†å½¢å¼çš„èªè¨€é¸æ“‡
- å³æ™‚èªè¨€åˆ‡æ›
- è¼‰å…¥ç‹€æ…‹é¡¯ç¤º

### 2. SimpleLanguageSelector
è¨­å®šé é¢å°ˆç”¨çš„èªè¨€é¸æ“‡å™¨ï¼š
- å¡ç‰‡å¼è¨­è¨ˆ
- å–®é¸æŒ‰éˆ•ä»‹é¢
- å³æ™‚ç‹€æ…‹æ›´æ–°

### 3. LanguageSettingsScreen
å®Œæ•´çš„èªè¨€è¨­å®šé é¢ï¼š
- ç•¶å‰èªè¨€è³‡è¨Šé¡¯ç¤º
- é€²éšè¨­å®šé¸é …
- æ”¯æ´èªè¨€æ¸…å–®

## ğŸ“ ç¿»è­¯è³‡æº

### ARB æª”æ¡ˆçµæ§‹
- `app_en.arb`: è‹±æ–‡ç¿»è­¯æ¨¡æ¿
- `app_zh.arb`: ä¸­æ–‡ç¿»è­¯ï¼ˆfallbackï¼‰
- `app_zh_TW.arb`: ç¹é«”ä¸­æ–‡ç¿»è­¯

### æ”¯æ´çš„ç¿»è­¯éµå€¼
- `appTitle`: æ‡‰ç”¨ç¨‹å¼æ¨™é¡Œ
- `home`: é¦–é 
- `settings`: è¨­å®š
- `language`: èªè¨€
- `theme`: ä¸»é¡Œ
- `airQuality`: ç©ºæ°£å“è³ª
- `news`: æ–°è
- `selectLanguage`: é¸æ“‡èªè¨€
- `english`: è‹±æ–‡
- `chineseTraditional`: ç¹é«”ä¸­æ–‡
- `cancel`: å–æ¶ˆ
- `confirm`: ç¢ºèª
- `languageChanged`: èªè¨€åˆ‡æ›æˆåŠŸ

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### 1. åŸºæœ¬ä½¿ç”¨
```dart
// åœ¨ Widget ä¸­ä½¿ç”¨
Consumer<LanguageProvider>(
  builder: (context, languageProvider, child) {
    return Text(languageProvider.currentLanguage);
  },
)

// åˆ‡æ›èªè¨€
context.read<LanguageProvider>().changeLanguage('en');
```

### 2. èªè¨€é¸æ“‡å™¨
```dart
// ç°¡æ½”ç‰ˆ
LanguageSelector()

// è¨­å®šé é¢ç‰ˆ
SimpleLanguageSelector()
```

### 3. èªè¨€è¨­å®šé é¢
```dart
Navigator.push(
  context,
  MaterialPageRoute(
    builder: (context) => const LanguageSettingsScreen(),
  ),
);
```

## ğŸ§ª æ¸¬è©¦

### æ¸¬è©¦æª”æ¡ˆ
- `test/features/settings/language/language_provider_test.dart`

### æ¸¬è©¦è¦†è“‹ç¯„åœ
- èªè¨€åˆ‡æ›åŠŸèƒ½
- éŒ¯èª¤è™•ç†
- ç‹€æ…‹ç®¡ç†
- é‚Šç•Œæƒ…æ³

### åŸ·è¡Œæ¸¬è©¦
```bash
flutter test test/features/settings/language/
```

## ğŸ”„ é–‹ç™¼æµç¨‹

### 1. æ–°å¢èªè¨€
1. åœ¨ `LanguageConstants` ä¸­æ–°å¢èªè¨€è³‡è¨Š
2. å»ºç«‹å°æ‡‰çš„ ARB ç¿»è­¯æª”æ¡ˆ
3. æ›´æ–° `supportedLocales` æ¸…å–®
4. æ¸¬è©¦èªè¨€åˆ‡æ›åŠŸèƒ½

### 2. æ–°å¢ç¿»è­¯
1. åœ¨ `app_en.arb` ä¸­æ–°å¢è‹±æ–‡ç¿»è­¯
2. åœ¨å„èªè¨€ ARB æª”æ¡ˆä¸­æ–°å¢å°æ‡‰ç¿»è­¯
3. åŸ·è¡Œ `flutter gen-l10n` é‡æ–°ç”Ÿæˆ
4. æ›´æ–° UI ä½¿ç”¨æ–°çš„ç¿»è­¯éµå€¼

### 3. ä¿®æ”¹èªè¨€é‚è¼¯
1. ä¿®æ”¹ `LanguageService` çš„åº•å±¤å¯¦ç¾
2. æ›´æ–° `LanguageProvider` çš„æ¥­å‹™é‚è¼¯
3. èª¿æ•´ UI çµ„ä»¶çš„é¡¯ç¤ºé‚è¼¯
4. æ›´æ–°ç›¸é—œæ¸¬è©¦

## ğŸ“Š æ•ˆèƒ½è€ƒé‡

### 1. è¨˜æ†¶é«”ç®¡ç†
- èªè¨€è³‡æºæŒ‰éœ€è¼‰å…¥
- åŠæ™‚é‡‹æ”¾ä¸ä½¿ç”¨çš„è³‡æº
- é¿å…è¨˜æ†¶é«”æ´©æ¼

### 2. è¼‰å…¥å„ªåŒ–
- å¿«å–å·²è¼‰å…¥çš„ç¿»è­¯è³‡æº
- é è¼‰å…¥å¸¸ç”¨èªè¨€
- å»¶é²è¼‰å…¥éå¿…è¦è³‡æº

### 3. ç‹€æ…‹æ›´æ–°
- æœ€å°åŒ–ä¸å¿…è¦çš„é‡å»º
- ä½¿ç”¨é©ç•¶çš„ Provider ç›£è½
- é¿å…éåº¦çš„ç‹€æ…‹æ›´æ–°

## ğŸ”’ å®‰å…¨æ€§

### 1. è¼¸å…¥é©—è­‰
- é©—è­‰èªè¨€ä»£ç¢¼çš„æœ‰æ•ˆæ€§
- æª¢æŸ¥ç¿»è­¯å…§å®¹çš„å®‰å…¨æ€§
- é˜²æ­¢æƒ¡æ„è¼¸å…¥

### 2. è³‡æ–™ä¿è­·
- åŠ å¯†æ•æ„Ÿçš„èªè¨€è¨­å®š
- ä¿è­·ä½¿ç”¨è€…éš±ç§
- å®‰å…¨çš„è³‡æ–™å‚³è¼¸

## ğŸ› å¸¸è¦‹å•é¡Œ

### 1. ç¿»è­¯ä¸é¡¯ç¤º
- æª¢æŸ¥ ARB æª”æ¡ˆæ ¼å¼
- ç¢ºèª gen-l10n å·²åŸ·è¡Œ
- é©—è­‰ AppLocalizations å°å…¥

### 2. èªè¨€åˆ‡æ›å¤±æ•—
- æª¢æŸ¥èªè¨€ä»£ç¢¼æ˜¯å¦æ”¯æ´
- ç¢ºèª SharedPreferences æ¬Šé™
- æŸ¥çœ‹éŒ¯èª¤æ—¥èªŒ

### 3. UI ä¸æ›´æ–°
- ç¢ºèª Provider ç›£è½æ­£ç¢º
- æª¢æŸ¥ notifyListeners å‘¼å«
- é©—è­‰ Consumer ä½¿ç”¨

## ğŸ“š ç›¸é—œæ–‡ä»¶

- [åœ‹éš›åŒ–é–‹ç™¼è¦ç¯„](./lang_rule.md)
- [ä¸»è¦é–‹ç™¼è¦ç¯„](../../../.cursor/RULES.md)
- [iOS è¨­è¨ˆè¦ç¯„](../../../.cursor/rules/ui/ios-style-rule.mdc)
- [æ—¥èªŒç³»çµ±è¦ç¯„](../../../.cursor/rules/log/log-rule.mdc)

---

**æœ€å¾Œæ›´æ–°**: 2025å¹´01æœˆ  
**ç‰ˆæœ¬**: 1.0.0  
**é©ç”¨ç¯„åœ**: PM25 æ‡‰ç”¨ç¨‹å¼å¤šèªè¨€åŠŸèƒ½
